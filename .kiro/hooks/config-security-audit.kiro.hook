{
  "enabled": true,
  "name": "config-security-audit",
  "description": "å®¡è®¡é…ç½®æ–‡ä»¶ä¸­çš„å®‰å…¨è®¾ç½®å’Œæ•æ„Ÿä¿¡æ¯",
  "version": "1",
  "when": {
    "type": "fileSaved",
    "filePattern": "*.{json,yaml,yml,toml,ini,conf,config}"
  },
  "then": {
    "type": "askAgent",
    "prompt": "å¯¹é¡¹ç›®ä¸­çš„å„ç±»é…ç½®æ–‡ä»¶è¿›è¡Œå®‰å…¨å®¡è®¡ï¼Œç¡®ä¿é…ç½®çš„å®‰å…¨æ€§ï¼š\n\n## 1. é…ç½®æ–‡ä»¶ç±»å‹è¯†åˆ«\n\n**Web æœåŠ¡å™¨é…ç½®ï¼š**\n- `nginx.conf`, `apache.conf` - Web æœåŠ¡å™¨é…ç½®\n- `docker-compose.yml` - å®¹å™¨ç¼–æ’é…ç½®\n- `Dockerfile` - å®¹å™¨æ„å»ºé…ç½®\n\n**åº”ç”¨é…ç½®ï¼š**\n- `config.json`, `settings.json` - åº”ç”¨é…ç½®\n- `database.yml` - æ•°æ®åº“é…ç½®\n- `redis.conf` - ç¼“å­˜é…ç½®\n\n**CI/CD é…ç½®ï¼š**\n- `.github/workflows/*.yml` - GitHub Actions\n- `gitlab-ci.yml` - GitLab CI\n- `jenkins.yml` - Jenkins é…ç½®\n\n## 2. æ•æ„Ÿä¿¡æ¯æ£€æµ‹\n\n**æ•°æ®åº“é…ç½®æ£€æŸ¥ï¼š**\n```yaml\n# âŒ ç¡¬ç¼–ç æ•°æ®åº“å‡­æ®\ndatabase:\n  host: localhost\n  username: admin\n  password: password123\n  database: myapp\n\n# âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡\ndatabase:\n  host: ${DB_HOST}\n  username: ${DB_USER}\n  password: ${DB_PASSWORD}\n  database: ${DB_NAME}\n```\n\n**API é…ç½®æ£€æŸ¥ï¼š**\n```json\n{\n  \"api\": {\n    \"key\": \"sk-1234567890abcdef\",     // âŒ ç¡¬ç¼–ç  API å¯†é’¥\n    \"endpoint\": \"https://api.example.com\"\n  }\n}\n```\n\n## 3. å®‰å…¨é…ç½®å®¡è®¡\n\n**Docker é…ç½®å®‰å…¨ï¼š**\n```dockerfile\n# âŒ å®‰å…¨é£é™©\nFROM ubuntu:latest          # ä¸æŒ‡å®šå…·ä½“ç‰ˆæœ¬\nUSER root                   # ä½¿ç”¨ root ç”¨æˆ·\nCOPY . /app                 # å¤åˆ¶æ‰€æœ‰æ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯\n\n# âœ… å®‰å…¨å®è·µ\nFROM ubuntu:20.04           # æŒ‡å®šå…·ä½“ç‰ˆæœ¬\nRUN adduser --disabled-password appuser\nUSER appuser                # ä½¿ç”¨é root ç”¨æˆ·\nCOPY --chown=appuser:appuser src/ /app/src/\n```\n\n**Nginx é…ç½®å®‰å…¨ï¼š**\n```nginx\n# âŒ ä¸å®‰å…¨é…ç½®\nserver {\n    server_tokens on;           # æš´éœ²æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯\n    add_header X-Frame-Options SAMEORIGIN;  # ç¼ºå°‘å…¶ä»–å®‰å…¨å¤´\n}\n\n# âœ… å®‰å…¨é…ç½®\nserver {\n    server_tokens off;\n    add_header X-Frame-Options DENY;\n    add_header X-Content-Type-Options nosniff;\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header Strict-Transport-Security \"max-age=31536000\";\n}\n```\n\n## 4. CI/CD é…ç½®å®‰å…¨\n\n**GitHub Actions å®‰å…¨æ£€æŸ¥ï¼š**\n```yaml\n# âŒ ä¸å®‰å…¨çš„ Actions é…ç½®\n- name: Deploy\n  run: |\n    echo \"API_KEY=sk-1234567890abcdef\" >> .env  # ç¡¬ç¼–ç å¯†é’¥\n    curl -H \"Authorization: Bearer $API_KEY\" ...\n\n# âœ… å®‰å…¨çš„ Actions é…ç½®\n- name: Deploy\n  env:\n    API_KEY: ${{ secrets.API_KEY }}  # ä½¿ç”¨ GitHub Secrets\n  run: |\n    curl -H \"Authorization: Bearer $API_KEY\" ...\n```\n\n**æƒé™æ£€æŸ¥ï¼š**\n```yaml\npermissions:\n  contents: read        # âœ… æœ€å°æƒé™åŸåˆ™\n  # contents: write     # âŒ é¿å…ä¸å¿…è¦çš„å†™æƒé™\n```\n\n## 5. æ•°æ®åº“é…ç½®å®‰å…¨\n\n**MongoDB é…ç½®ï¼š**\n```yaml\n# âŒ ä¸å®‰å…¨é…ç½®\nmongodb:\n  host: 0.0.0.0         # ç›‘å¬æ‰€æœ‰æ¥å£\n  auth: false           # ç¦ç”¨è®¤è¯\n\n# âœ… å®‰å…¨é…ç½®\nmongodb:\n  host: 127.0.0.1       # åªç›‘å¬æœ¬åœ°\n  auth: true            # å¯ç”¨è®¤è¯\n  ssl: true             # å¯ç”¨ SSL\n```\n\n**Redis é…ç½®ï¼š**\n```conf\n# âŒ ä¸å®‰å…¨é…ç½®\nbind 0.0.0.0\nprotected-mode no\n\n# âœ… å®‰å…¨é…ç½®\nbind 127.0.0.1\nprotected-mode yes\nrequirepass ${REDIS_PASSWORD}\n```\n\n## 6. å¼€å‘ç¯å¢ƒé…ç½®æ£€æŸ¥\n\n**è°ƒè¯•æ¨¡å¼æ£€æŸ¥ï¼š**\n```json\n{\n  \"debug\": true,           // âš ï¸  ç”Ÿäº§ç¯å¢ƒåº”ä¸º false\n  \"verbose\": true,         // âš ï¸  å¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯\n  \"logLevel\": \"debug\"      // âš ï¸  ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ \"error\" æˆ– \"warn\"\n}\n```\n\n**CORS é…ç½®æ£€æŸ¥ï¼š**\n```json\n{\n  \"cors\": {\n    \"origin\": \"*\",         // âŒ å…è®¸æ‰€æœ‰åŸŸåè®¿é—®\n    \"credentials\": true    // âŒ ä¸é€šé…ç¬¦ origin å†²çª\n  }\n}\n```\n\n## 7. è¾“å‡ºæ ¼å¼\n\n**å‘ç°å®‰å…¨é—®é¢˜ï¼š**\n```\nğŸ”’ é…ç½®å®‰å…¨å®¡è®¡æŠ¥å‘Š\nğŸ“ æ–‡ä»¶ï¼šconfig/database.yml\n\nğŸš¨ ä¸¥é‡é—®é¢˜ï¼š\n- ç¬¬ 5 è¡Œï¼šç¡¬ç¼–ç æ•°æ®åº“å¯†ç \n  ğŸ”§ ä¿®å¤ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ ${DB_PASSWORD}\n\nâš ï¸  è­¦å‘Šé—®é¢˜ï¼š\n- ç¬¬ 12 è¡Œï¼šdebug æ¨¡å¼åœ¨ç”Ÿäº§é…ç½®ä¸­å¯ç”¨\n  ğŸ”§ ä¿®å¤ï¼šè®¾ç½® debug: false\n\nğŸ’¡ å»ºè®®ï¼š\n- å°†æ‰€æœ‰æ•æ„Ÿé…ç½®ç§»è‡³ç¯å¢ƒå˜é‡\n- ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºç‹¬ç«‹çš„é…ç½®æ–‡ä»¶\n- å¯ç”¨é…ç½®æ–‡ä»¶çš„è®¿é—®æƒé™æ§åˆ¶\n```\n\n**å®‰å…¨é€šè¿‡ï¼š**\n```\nâœ… é…ç½®å®‰å…¨å®¡è®¡é€šè¿‡\nğŸ“ æ–‡ä»¶ï¼šnginx.conf\nğŸ” æ£€æŸ¥äº†å®‰å…¨å¤´ã€æƒé™è®¾ç½®ã€ç›‘å¬é…ç½®\nğŸ”’ é…ç½®ç¬¦åˆå®‰å…¨æœ€ä½³å®è·µ\n```\n\nè¯·ç«‹å³å®¡è®¡åˆšä¿å­˜çš„é…ç½®æ–‡ä»¶ã€‚"
  }
}